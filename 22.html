<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»Ÿæ§åˆ¶å° - ä¿®ä»™ä¸–ç•Œæ“çºµè€…</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background-color: #f4f3ee;
            color: #6d6a75;
            overflow: hidden;
            height: 100vh;
        }
        .status-bar {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 12px;
            height: auto;
            background: none;
            border: none;
            padding: 0;
            box-shadow: none;
            margin-bottom: 8px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .system-level, .level-badge, .exp-bar, .exp-fill { display: none !important; }
        .status-indicators { display: flex; gap: 30px; }
        .indicator { text-align: center; }
        .indicator-label { font-size: 12px; opacity: 0.7; }
        .indicator-value { font-size: 24px; font-weight: bold; }
        .trust-meter { color: #b5aacb; }
        .backlash-meter { color: #d8b4a6; }
        .points-display { background: rgba(181, 170, 203, 0.1); border: 1px solid #b5aacb; padding: 10px 20px; border-radius: 5px; }
        .tab-bar { display: flex; justify-content: center; align-items: center; background: linear-gradient(90deg, #b5aacb 0%, #f4f3ee 100%); border-bottom: 2px solid #b8a398; height: 48px; }
        .tab-btn { background: none; border: none; color: #b5aacb; font-size: 18px; padding: 10px 32px; cursor: pointer; transition: background 0.2s, color 0.2s; border-radius: 8px 8px 0 0; margin: 0 8px; outline: none; }
        .tab-btn.active, .tab-btn:hover { background: #b5aacb; color: #f4f3ee; }
        .tab-content { width: 90vw; max-width: 1200px; margin: 24px auto 0 auto; background: rgba(181, 170, 203, 0.10); border: 1.5px solid #b5aacb; border-radius: 10px; min-height: 70vh; max-height: calc(100vh - 60px - 48px - 32px); box-shadow: 0 0 24px #b5aacb40; overflow-y: auto; overflow-x: hidden; padding: 32px 32px 24px 32px; position: relative; -webkit-overflow-scrolling: touch; }
        .left-panel, .center-panel, .right-panel { width: 100% !important; background: none; border: none; padding: 0; overflow: visible; }
        .left-panel .tool-section, .right-panel .tool-section { margin-bottom: 30px; }
        .section-title { color: #a3b1c6; margin-bottom: 15px; font-size: 18px; text-transform: uppercase; letter-spacing: 2px; }
        .tool-button { width: 100%; padding: 12px; margin-bottom: 10px; background: rgba(181, 170, 203, 0.1); border: 1px solid #b5aacb; color: #b5aacb; cursor: pointer; transition: all 0.3s ease; font-size: 14px; }
        .tool-button:hover { background: rgba(181, 170, 203, 0.45); transform: translateX(5px); }
        .tool-button.locked { opacity: 0.3; cursor: not-allowed; border-color: #bfc1c2; color: #bfc1c2; }
        .tool-button.danger { border-color: #d8b4a6; color: #d8b4a6; }
        .scene-window { background: rgba(163, 177, 198, 0.2); border: 1px solid #a3b1c6; padding: 20px; margin-bottom: 20px; border-radius: 5px; }
        .scene-title { color: #a3b1c6; margin-bottom: 10px; font-size: 20px; }
        .scene-description { color: #6d6a75; line-height: 1.6; margin-bottom: 15px; }
        .protagonist-thoughts { background: rgba(216, 180, 166, 0.10); padding: 15px; border-left: 3px solid #d8b4a6; margin: 15px 0; font-style: italic; color: #d8b4a6; }
        .choice-preview { margin-top: 20px; }
        .choice-option { background: rgba(183, 190, 156, 0.10); border: 1px solid #b7be9c; padding: 15px; margin-bottom: 10px; cursor: pointer; position: relative; transition: all 0.3s ease; }
        .choice-option:hover { background: #b5aacb; color: #fff; }
        .choice-text { color: #4d4d4d; margin-bottom: 5px; }
        .choice-consequences { font-size: 12px; color: #7d9272; opacity: 0.85; }
        .trust-impact { position: absolute; right: 15px; top: 15px; font-weight: bold; }
        .trust-positive { color: #7d9272; }
        .trust-negative { color: #b7be9c; }
        .npc-thoughts { background: rgba(183, 190, 156, 0.10); border: 1px solid #b7be9c; padding: 15px; margin-bottom: 15px; border-radius: 5px; }
        .npc-name { color: #7d9272; font-weight: bold; margin-bottom: 5px; }
        .npc-thought { color: #4d4d4d; font-size: 14px; font-style: italic; }
        .hidden-info { background: rgba(183, 190, 156, 0.10); border: 1px solid #b7be9c; padding: 10px; margin-bottom: 10px; font-size: 14px; }
        .world-event { background: rgba(183, 190, 156, 0.10); border-left: 3px solid #b7be9c; padding: 10px; margin-bottom: 10px; font-size: 14px; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e5e7da; }
        ::-webkit-scrollbar-thumb { background: #b7be9c; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a9b7a0; }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes dataflow { 0% { transform: translateY(0); } 100% { transform: translateY(100px); } }
        .data-stream { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; opacity: 0.1; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="20" font-size="10" fill="%23b7be9c" opacity="0.5">01001010</text></svg>'); animation: dataflow 20s linear infinite; }
        @media (max-width: 900px) {
            .tab-content { width: 98vw; max-width: 100vw; padding: 12px 4vw 16px 4vw; font-size: 15px; }
            .tab-bar { height: 44px; }
            .tab-btn { font-size: 15px; padding: 8px 10px; margin: 0 2px; }
            .scene-title { font-size: 17px; }
            .section-title { font-size: 15px; }
            .tool-button { font-size: 13px; padding: 10px; }
        }
        @media (max-width: 600px) {
            .tab-content { width: 100vw; max-width: 100vw; min-height: 60vh; max-height: calc(100vh - 60px - 44px - 10px); padding: 8px 2vw 12px 2vw; font-size: 13px; }
            .tab-bar { height: 40px; }
            .tab-btn { font-size: 13px; padding: 6px 4px; }
            .scene-title { font-size: 15px; }
            .section-title { font-size: 13px; }
            .tool-button { font-size: 12px; padding: 8px; }
            .status-indicators { flex-direction: column; gap: 8px; align-items: flex-start; }
            .indicator-label { font-size: 11px; }
            .indicator-value { font-size: 18px; }
            .points-display { padding: 6px 10px; font-size: 13px; }
            .status-bar { flex-direction: column; height: auto; padding: 6px 4px; }
            .system-level { flex-direction: column; gap: 4px; }
            .exp-bar { width: 100px; }
            .level-badge { font-size: 13px; padding: 3px 10px; }
            .status-indicators { width: 100%; }
            .status-bar { flex-direction: row; height: auto; padding: 4px 2vw 4px 2vw; align-items: flex-end; }
            .system-level { flex-direction: column; gap: 2px; }
            .exp-bar { width: 80px; }
            .level-badge { font-size: 12px; padding: 2px 8px; }
            .status-indicators { flex-direction: row; gap: 8px; width: auto; }
            .status-indicators .indicator:nth-child(2) { display: none; }
            .indicator-label { font-size: 11px; }
            .indicator-value { font-size: 16px; }
            .points-display { padding: 4px 8px; font-size: 12px; }
            .tab-bar { margin-top: 2px; }
        }
        .tab-content::-webkit-scrollbar { width: 8px; background: #e5e7da; }
        .tab-content::-webkit-scrollbar-thumb { background: #b7be9c; border-radius: 4px; }
        .tab-content::-webkit-scrollbar-thumb:hover { background: #a9b7a0; }
        .tab-content { scrollbar-width: thin; scrollbar-color: #b7be9c #e5e7da; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #e5e7da; border: 2px solid #b7be9c; padding: 30px; border-radius: 10px; min-width: 400px; }
        .modal-title { color: #7d9272; font-size: 24px; margin-bottom: 20px; }
        .modal-body { color: #4d4d4d; margin-bottom: 20px; }
        .modal-actions { display: flex; gap: 10px; justify-content: flex-end; }
        .choice-option:hover .choice-consequences {
            color: #4d4d4d !important;
        }
        .choice-option:hover .trust-impact {
            color: #4d4d4d !important;
        }
    </style>
</head>
<body>
    <div class="data-stream"></div>
    <div class="status-bar">
        <div class="system-level">
            <div class="level-badge">ç³»ç»Ÿ Lv.3</div>
            <div class="exp-bar"><div class="exp-fill"></div></div>
            <span style="font-size: 12px; opacity: 0.7;">2450/5000 EXP</span>
        </div>
        <div class="status-indicators">
            <div class="indicator">
                <div class="indicator-label">ä¸»è§’ä¿¡ä»»åº¦</div>
                <div class="indicator-value trust-meter">78%</div>
            </div>
            <div class="indicator">
                <div class="indicator-label">ä¸–ç•Œåå™¬å€¼</div>
                <div class="indicator-value backlash-meter">âš  45</div>
            </div>
            <div class="indicator points-display">
                <div class="indicator-label">å¯ç”¨ç§¯åˆ†</div>
                <div class="indicator-value">12,500</div>
            </div>
        </div>
    </div>
    <div class="tab-bar">
        <button class="tab-btn" data-tab="left">å·¥å…·é¢æ¿</button>
        <button class="tab-btn active" data-tab="center">ä¸»è§’çª—å£</button>
        <button class="tab-btn" data-tab="right">å…¨çŸ¥é¢æ¿</button>
    </div>
    <div class="tab-content">
        <!-- å·¥å…·é¢æ¿ -->
        <div class="left-panel tab-panel" data-tab="left" style="display: none;">
            <div class="tool-section">
                <h3 class="section-title">ä¿¡æ¯æ“æ§</h3>
                <button class="tool-button" onclick="showInfoControl()">é€éœ²ä¿¡æ¯</button>
                <button class="tool-button" onclick="hideInfo()">éšè—çœŸç›¸</button>
                <button class="tool-button danger" onclick="mislead()">è¯¯å¯¼ä¸»è§’</button>
                <button class="tool-button" onclick="staySilent()">ä¿æŒæ²‰é»˜</button>
            </div>
            <div class="tool-section">
                <h3 class="section-title">ç³»ç»Ÿå¹²é¢„</h3>
                <button class="tool-button" onclick="viewStats()">æŸ¥çœ‹å±æ€§</button>
                <button class="tool-button" onclick="openShop()">æ‰“å¼€å•†åŸ</button>
                <button class="tool-button" onclick="pauseTime()">æš‚åœæ—¶é—´</button>
                <button class="tool-button" id="memoryEditBtn">è®°å¿†ç¼–è¾‘</button>
                <button class="tool-button" onclick="timeRewind()">æ—¶å…‰å›æº¯</button>
                <button class="tool-button" onclick="materialize()">å®ä½“åŒ–</button>
            </div>
            <div class="tool-section">
                <h3 class="section-title">å¿«æ·æ“ä½œ</h3>
                <button class="tool-button" onclick="createTask()">å‘å¸ƒä»»åŠ¡</button>
                <button class="tool-button" onclick="checkAnchors()">æ—¶é—´é”šç‚¹</button>
                <button class="tool-button" onclick="viewLogs()">ç³»ç»Ÿæ—¥å¿—</button>
            </div>
        </div>
        <!-- ä¸»è§’çª—å£ -->
        <div class="center-panel tab-panel" data-tab="center" style="display: block;">
            <div class="scene-window">
                <h2 class="scene-title">ã€é’äº‘å®—Â·å¤–é—¨å¹¿åœºã€‘</h2>
                <div class="scene-description">
                    æ™¨é›¾ç¼­ç»•çš„å¹¿åœºä¸Šï¼Œæ•°ç™¾åå¤–é—¨å¼Ÿå­æ­£åœ¨æ™¨ç»ƒã€‚ä¸»è§’ç«™åœ¨äººç¾¤è¾¹ç¼˜ï¼Œçœ‹ç€è¿œå¤„å†…é—¨çš„æ–¹å‘è‹¥æœ‰æ‰€æ€ã€‚
                    ä¸€ä¸ªèº«å½±æ­£å¿«é€Ÿæ¥è¿‘â€”â€”æ˜¯å¤–é—¨ç®¡äº‹æé•¿é£ã€‚
                </div>
                <div class="protagonist-thoughts">
                    ğŸ’­ ä¸»è§’å†…å¿ƒï¼šã€Œæé•¿é£çªç„¶æ‰¾æˆ‘ï¼Œéš¾é“æ˜¯å› ä¸ºæ˜¨å¤©æˆ‘å±•ç°çš„å‰‘æ³•ï¼Ÿä¸ï¼Œæˆ‘æ˜æ˜å·²ç»åˆ»æ„éšè—äº†å®åŠ›...ã€
                </div>
                <div class="npc-dialogue" style="background: rgba(0,100,200,0.1); padding: 15px; border-radius: 5px; margin: 15px 0;">
                    <strong style="color: #a3b1c6;">æé•¿é£ï¼š</strong>
                    <span style="color: #6d6a75;">"æ—å‡¡ï¼ŒæŒé—¨æœ‰ä»¤ï¼Œè®©ä½ å³åˆ»å‰å¾€ä¸»å³°å¤§æ®¿ã€‚è®°ä½ï¼Œé—®ä»€ä¹ˆç­”ä»€ä¹ˆï¼Œä¸è¦å¤šè¯´ã€‚"</span>
                </div>
                <div class="choice-preview">
                    <h3 style="color: #b5aacb; margin-bottom: 15px;">ä¸»è§’é€‰æ‹©é¢„è§ˆï¼š</h3>
                    <div class="choice-option" onclick="handleChoice(1)">
                        <div class="choice-text" style="color: #4d4d4d;">1. "æ˜¯ï¼Œå¼Ÿå­è¿™å°±å‰å¾€ã€‚"</div>
                        <div class="choice-consequences" style="color: #b5aacb;">â†’ é¡ºä»è¡¨ç°ï¼Œé™ä½æ€€ç–‘ | å¯èƒ½é”™è¿‡é‡è¦ä¿¡æ¯</div>
                        <span class="trust-impact trust-positive" style="color: #b5aacb;">ä¿¡ä»»åº¦ +5</span>
                    </div>
                    <div class="choice-option" onclick="handleChoice(2)">
                        <div class="choice-text" style="color: #4d4d4d;">2. "æ•¢é—®ç®¡äº‹ï¼ŒæŒé—¨å¬è§æ‰€ä¸ºä½•äº‹ï¼Ÿ"</div>
                        <div class="choice-consequences" style="color: #b5aacb;">â†’ å¯èƒ½è·å¾—çº¿ç´¢ | æ˜¾å¾—è¿‡äºæœºè­¦</div>
                        <span class="trust-impact trust-negative" style="color: #d8b4a6;">ä¿¡ä»»åº¦ -2</span>
                    </div>
                    <div class="choice-option" onclick="handleChoice(3)">
                        <div class="choice-text" style="color: #4d4d4d;">3. "æˆ‘éœ€è¦å‡†å¤‡ä»€ä¹ˆå—ï¼Ÿè¿™æ˜¯å¦ä¸æ˜¨æ—¥ä¹‹äº‹æœ‰å…³ï¼Ÿ"</div>
                        <div class="choice-consequences" style="color: #b5aacb;">â†’ æš´éœ²çŸ¥æƒ… | æé•¿é£æ€€ç–‘å€¼ +15</div>
                        <span class="trust-impact trust-negative" style="color: #d8b4a6;">ä¿¡ä»»åº¦ -8</span>
                    </div>
                </div>
            </div>
            <div class="system-intervention" style="background: rgba(0,255,136,0.1); border: 2px dashed #00ff88; padding: 20px; margin-top: 20px;">
                <h3 style="color: #b5aacb; margin-bottom: 10px;">ğŸ® ç³»ç»Ÿä»‹å…¥é€‰é¡¹</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button class="tool-button" style="background:rgba(181,170,203,0.12);border:1px solid #b5aacb;color:#b5aacb;" onclick="provideHint()">
                        ğŸ’¡ æä¾›æç¤º
                        <span id="hintCost" style="font-size: 12px; display: block; opacity: 0.7; color:#b5aacb;">æ¶ˆè€—: 100ç§¯åˆ†</span>
                    </button>
                    <button class="tool-button" style="background:rgba(181,170,203,0.12);border:1px solid #b5aacb;color:#b5aacb;" onclick="revealTruth()">
                        ğŸ‘ï¸ æ­ç¤ºçœŸç›¸
                        <span id="truthCost" style="font-size: 12px; display: block; opacity: 0.7; color:#b5aacb;">æ¶ˆè€—: 500ç§¯åˆ† | åå™¬+10</span>
                    </button>
                    <button class="tool-button danger" style="border-color:#d8b4a6;color:#d8b4a6;background:rgba(216,180,166,0.10);" onclick="misleadNow()">
                        ğŸ­ è¯¯å¯¼ä¸»è§’
                        <span style="font-size: 12px; display: block; opacity: 0.7; color:#d8b4a6;">ä¿¡ä»»åº¦-10</span>
                    </button>
                    <button class="tool-button" style="background:rgba(181,170,203,0.12);border:1px solid #b5aacb;color:#b5aacb;" onclick="stayQuiet()">
                        ğŸ¤ ä¿æŒæ²‰é»˜
                        <span style="font-size: 12px; display: block; opacity: 0.7; color:#b5aacb;">æ— æ¶ˆè€—</span>
                    </button>
                </div>
            </div>
        </div>
        <!-- å…¨çŸ¥é¢æ¿ -->
        <div class="right-panel tab-panel" data-tab="right" style="display: none;">
            <div class="tool-section">
                <h3 class="section-title">NPCçœŸå®æƒ³æ³•</h3>
                <div class="npc-thoughts">
                    <div class="npc-name">æé•¿é£ [æ€€ç–‘åº¦: 35%]</div>
                    <div class="npc-thought">
                        "è¿™å°å­æ˜¨å¤©é‚£ä¸€å‰‘...ç»ä¸æ˜¯å¤–é—¨å¼Ÿå­è¯¥æœ‰çš„é€ è¯£ã€‚æŒé—¨çªç„¶å¬è§ï¼Œææ€•ä¹Ÿæ˜¯å¯Ÿè§‰åˆ°äº†ä»€ä¹ˆã€‚æˆ‘å¾—å°å¿ƒè§‚å¯Ÿä»–çš„ååº”ã€‚"
                    </div>
                </div>
                <div class="npc-thoughts">
                    <div class="npc-name">æš—ä¸­è§‚å¯Ÿè€… - å†…é—¨æ‰§äº‹èµµæ˜</div>
                    <div class="npc-thought">
                        "æœ‰æ„æ€ï¼ŒæŒé—¨ç«Ÿç„¶äº²è‡ªå¬è§ä¸€ä¸ªå¤–é—¨å¼Ÿå­ã€‚çœ‹æ¥æˆ‘çš„æƒ…æŠ¥æ²¡é”™ï¼Œè¿™ä¸ªæ—å‡¡ç¡®å®æœ‰å¤æ€ªã€‚"
                    </div>
                </div>
            </div>
            <div class="tool-section">
                <h3 class="section-title">éšè—ä¿¡æ¯</h3>
                <div class="hidden-info">
                    <strong>ğŸ”´ æœºå¯†ï¼š</strong>æŒé—¨å·²ç»é€šè¿‡å¤©æœºæ¨æ¼”å‘ç°ä¸»è§’èº«è´Ÿå¼‚å®ï¼Œæ­¤æ¬¡å¬è§æ˜¯ä¸€æ¬¡è¯•æ¢ã€‚
                </div>
                <div class="hidden-info">
                    <strong>ğŸ”´ å±é™©ï¼š</strong>é­”é—¨é—´è°å·²æ½œå…¥é’äº‘å®—ï¼Œæ­£åœ¨å¯»æ‰¾èº«è´Ÿ"å¤©é“ç§å­"ä¹‹äººã€‚
                </div>
            </div>
            <div class="tool-section">
                <h3 class="section-title">ä¸–ç•Œæš—æµ</h3>
                <div class="world-event">
                    <strong>ã€å¦–æ—åŠ¨å‘ã€‘</strong><br>
                    ç™½æ³½ä¸€è„‰æ­£åœ¨é›†ç»“åŠ›é‡ï¼Œä¸‰æ—¥åå°†æœ‰å¤§åŠ¨ä½œã€‚
                </div>
                <div class="world-event">
                    <strong>ã€çš‡æ—å¯†ä»¤ã€‘</strong><br>
                    ä¸‰çš‡å­å·²æ´¾å‡ºå¯†æ¢è°ƒæŸ¥å„å¤§å®—é—¨å¤©æ‰å¼Ÿå­ã€‚
                </div>
                <div class="world-event">
                    <strong>ã€å¤©æœºå¼‚åŠ¨ã€‘</strong><br>
                    å¤©æœºé˜æ£€æµ‹åˆ°å‘½è¿çº¿å‡ºç°æ‰°åŠ¨ï¼Œæºå¤´æŒ‡å‘é’äº‘å®—ã€‚
                </div>
            </div>
            <div class="tool-section">
                <h3 class="section-title">å› æœé¢„æµ‹</h3>
                <div style="background: rgba(255,255,0,0.1); padding: 15px; border-radius: 5px;">
                    <div style="margin-bottom: 10px;">
                        <strong>é€‰æ‹©1åæœï¼š</strong>å®‰å…¨é€šè¿‡ï¼Œä½†é”™è¿‡è·çŸ¥æŒé—¨çœŸå®æ„å›¾çš„æœºä¼š
                    </div>
                    <div style="margin-bottom: 10px;">
                        <strong>é€‰æ‹©2åæœï¼š</strong>æé•¿é£ä¼šé€éœ²"ä¸ä½ çš„å¤©èµ‹æœ‰å…³"
                    </div>
                    <div>
                        <strong>é€‰æ‹©3åæœï¼š</strong>è§¦å‘æé•¿é£è­¦è§‰äº‹ä»¶ï¼Œå¯èƒ½å¯¼è‡´åç»­ç›‘è§†
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="intervention-prompt" onclick="showInterventionMenu()">
        âš¡ æ£€æµ‹åˆ°å…³é”®å‰§æƒ…ç‚¹ï¼Œæ˜¯å¦ä»‹å…¥ï¼Ÿ
    </div>
    <!-- ä¿¡æ¯æ§åˆ¶å¼¹çª— -->
    <div id="infoControlModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">ä¿¡æ¯é€éœ²æ§åˆ¶</h2>
            <div class="modal-body">
                <p style="margin-bottom: 15px;">é€‰æ‹©è¦å‘Šè¯‰ä¸»è§’çš„ä¿¡æ¯ï¼š</p>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="info1">
                        <span>æé•¿é£å¯¹ä½ æœ‰æ‰€æ€€ç–‘ï¼ˆä½ä»·å€¼ä¿¡æ¯ï¼‰</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="info2">
                        <span>æŒé—¨æ­¤æ¬¡å¬è§æ˜¯ä¸ºäº†è¯•æ¢ä½ ï¼ˆä¸­ä»·å€¼ä¿¡æ¯ï¼‰</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="info3">
                        <span>æŒé—¨å·²çŸ¥ä½ èº«è´Ÿå¼‚å®ï¼ˆé«˜ä»·å€¼ä¿¡æ¯ï¼‰</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="info4">
                        <span>å®—é—¨å†…æœ‰é­”é—¨é—´è°ï¼ˆå±é™©ä¿¡æ¯ï¼‰</span>
                    </label>
                </div>
                <div style="margin-top: 20px; padding: 10px; background: rgba(255,170,0,0.2); border-radius: 5px;">
                    <strong>é¢„è®¡å½±å“ï¼š</strong>
                    <div id="infoImpact">è¯·é€‰æ‹©è¦é€éœ²çš„ä¿¡æ¯</div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="confirmInfoReveal()">ç¡®è®¤é€éœ²</button>
                <button class="tool-button" onclick="closeModal('infoControlModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
    <!-- å•†åŸå¼¹çª— -->
    <div id="shopModal" class="modal">
        <div class="modal-content" style="min-width: 600px;">
            <h2 class="modal-title">ç³»ç»Ÿå•†åŸ - åå°æ§åˆ¶</h2>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div class="shop-item" style="background: rgba(0,255,136,0.1); padding: 15px; border: 1px solid #00ff88; border-radius: 5px;">
                        <h4 style="color: #00ff88;">æ´å¯Ÿç¬¦</h4>
                        <p style="font-size: 14px; margin: 10px 0;">æŸ¥çœ‹NPCå¥½æ„Ÿåº¦</p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>500ç§¯åˆ†</span>
                            <button class="tool-button" style="padding: 5px 10px;" onclick="setPrice('item1')">æ”¹ä»·</button>
                        </div>
                    </div>
                    <div class="shop-item" style="background: rgba(0,255,136,0.1); padding: 15px; border: 1px solid #00ff88; border-radius: 5px;">
                        <h4 style="color: #00ff88;">è®°å¿†æ¨¡ç³Šä¸¹</h4>
                        <p style="font-size: 14px; margin: 10px 0;">è®©NPCå¿˜è®°ä¸€ä»¶å°äº‹</p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>2000ç§¯åˆ†</span>
                            <button class="tool-button" style="padding: 5px 10px;" onclick="setPrice('item2')">æ”¹ä»·</button>
                        </div>
                    </div>
                    <div class="shop-item" style="background: rgba(255,100,100,0.1); padding: 15px; border: 1px solid #ff6666; border-radius: 5px;">
                        <h4 style="color: #ff6666;">å‘½è¿åç§»å¡</h4>
                        <p style="font-size: 14px; margin: 10px 0;">æ”¹å˜ä¸€æ¬¡å‰§æƒ…èµ°å‘</p>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>10000ç§¯åˆ†</span>
                            <button class="tool-button locked" style="padding: 5px 10px;">æœªè§£é”</button>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,0,0.1); border-radius: 5px;">
                    <strong>å•†åŸæ“ä½œï¼š</strong>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button class="tool-button" onclick="createSale()">åˆ¶é€ é™æ—¶ä¼˜æƒ </button>
                        <button class="tool-button" onclick="hideItems()">éšè—éƒ¨åˆ†å•†å“</button>
                        <button class="tool-button danger" onclick="createFakeUrgency()">åˆ¶é€ ç¼ºè´§å‡è±¡</button>
                        <button class="tool-button" onclick="showAddProductModal()" style="background:rgba(0,255,136,0.15);color:#00ff88;">ä¸Šæ¶æ–°å•†å“</button>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="closeModal('shopModal')">å…³é—­</button>
            </div>
        </div>
    </div>
    <!-- ç¼–è¾‘å•†å“å¼¹çª— -->
    <div id="editProductModal" class="modal">
        <div class="modal-content" style="min-width:400px;">
            <h2 class="modal-title">ç¼–è¾‘å•†å“</h2>
            <div class="modal-body">
                <div style="margin-bottom:10px;">
                    <label>å•†å“åç§°</label>
                    <input type="text" id="editProductName" style="width:100%;padding:8px;background:#222;border:1px solid #666;color:#aaa;" readonly>
                </div>
                <div style="margin-bottom:10px;">
                    <label>åŠŸèƒ½/æè¿°</label>
                    <input type="text" id="editProductDesc" style="width:100%;padding:8px;background:#222;border:1px solid #666;color:#aaa;" readonly>
                </div>
                <div style="margin-bottom:10px;">
                    <label>ç§¯åˆ†ä»·æ ¼</label>
                    <input type="number" id="editProductPrice" style="width:100%;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;">
                </div>
                <div style="margin-bottom:10px;">
                    <label>åº“å­˜æ•°é‡</label>
                    <input type="number" id="editProductStock" style="width:100%;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;">
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="saveEditProduct()">ä¿å­˜</button>
                <button class="tool-button" onclick="closeModal('editProductModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="closeModal('shopModal')">å…³é—­</button>
            </div>
        </div>
    </div>
    <!-- ä¸Šæ¶å•†å“å¼¹çª— -->
    <div id="addProductModal" class="modal">
        <div class="modal-content" style="min-width:400px;">
            <h2 class="modal-title">ä¸Šæ¶æ–°å•†å“</h2>
            <div class="modal-body">
                <div style="margin-bottom:15px;">
                    <label>å•†å“åç§°</label>
                    <input type="text" id="productName" style="width:100%;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;">
                </div>
                <div style="margin-bottom:15px;">
                    <label>åŠŸèƒ½/æè¿°</label>
                    <input type="text" id="productDesc" style="width:100%;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;" placeholder="å¦‚ï¼šæå‡å±æ€§ã€ç‰¹æ®Šæ•ˆæœç­‰">
                </div>
                <div style="margin-bottom:15px;">
                    <label>ç§¯åˆ†ä»·æ ¼</label>
                    <input type="number" id="productPrice" style="width:100%;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;">
                </div>
                <div style="margin-bottom:15px;">
                    <label>åº“å­˜æ•°é‡</label>
                    <input type="number" id="productStock" style="width:100%;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;">
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="addProduct()">ç¡®è®¤ä¸Šæ¶</button>
                <button class="tool-button" onclick="closeModal('addProductModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
    <!-- å…¶å®ƒå¼¹çª—å¦‚ä»»åŠ¡ç¼–è¾‘å™¨ã€æ—¶é—´é”šç‚¹ã€ç³»ç»Ÿæ—¥å¿—ç­‰ç”±JSåŠ¨æ€åˆ›å»º -->
    <!-- è®°å¿†ç¼–è¾‘å¼¹çª— -->
    <div id="memoryEditModal" class="modal">
        <div class="modal-content" style="min-width:400px;">
            <h2 class="modal-title">è®°å¿†ç¼–è¾‘</h2>
            <div class="modal-body">
                <div style="margin-bottom:15px;">
                    <label>é€‰æ‹©NPC</label>
                    <select id="memoryNpc" style="width:100%;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;">
                        <option value="æé•¿é£">æé•¿é£</option>
                        <option value="èµµæ˜">èµµæ˜</option>
                        <option value="ä¸»è§’">ä¸»è§’</option>
                    </select>
                </div>
                <div style="margin-bottom:15px;">
                    <label>è®°å¿†å†…å®¹</label>
                    <textarea id="memoryContent" style="width:100%;height:80px;padding:8px;background:#1a1a1a;border:1px solid #00ff88;color:#fff;" placeholder="è¯·è¾“å…¥è¦ç¼–è¾‘çš„è®°å¿†å†…å®¹"></textarea>
                </div>
                <div style="color:#ffaa00;font-size:13px;margin-bottom:10px;">
                    æ¶ˆè€—ï¼š<span id="memoryEditCost"></span> ç§¯åˆ†
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="memoryEditSave()">ä¿å­˜</button>
                <button class="tool-button" onclick="closeModal('memoryEditModal')">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
<!-- å·²åˆ é™¤å¤šä½™çš„é‡å¤è®°å¿†ç¼–è¾‘å¼¹çª—ï¼Œé¿å…idå†²çªå’Œç»“æ„æ··ä¹± -->
    <script>
    // ç³»ç»Ÿç­‰çº§ï¼ˆå¯æ ¹æ®å®é™…æƒ…å†µåŠ¨æ€èµ‹å€¼ï¼‰
    let systemLevel = 3; // ä¾‹ï¼š3çº§ï¼Œåç»­å¯æ¥å…¥å®é™…ç­‰çº§

    // è·å–æŠ˜æ‰£åç§¯åˆ†
    function getDiscountedCost(baseCost) {
        if (systemLevel >= 10) return Math.floor(baseCost * 0.5);
        if (systemLevel >= 7) return Math.floor(baseCost * 0.7);
        if (systemLevel >= 5) return Math.floor(baseCost * 0.8);
        if (systemLevel >= 3) return Math.floor(baseCost * 0.9);
        return baseCost;
    }

    // åŠ¨æ€åˆ·æ–°ç³»ç»Ÿå¹²é¢„æ¶ˆè€—æ˜¾ç¤º
    function updateInterventionCosts() {
        if(document.getElementById('hintCost')) {
            document.getElementById('hintCost').textContent = 'æ¶ˆè€—: ' + getDiscountedCost(100) + 'ç§¯åˆ†';
        }
        if(document.getElementById('truthCost')) {
            document.getElementById('truthCost').textContent = 'æ¶ˆè€—: ' + getDiscountedCost(500) + 'ç§¯åˆ† | åå™¬+10';
        }
    }
    document.addEventListener('DOMContentLoaded', function() {
        updateInterventionCosts();
    });

    // ç³»ç»Ÿå¹²é¢„åŠŸèƒ½å®ç°
    function provideHint() {
        const cost = getDiscountedCost(100);
        if(confirm(`ç¡®å®šæ¶ˆè€—${cost}ç§¯åˆ†æä¾›æç¤ºï¼Ÿ`)) {
            if(typeof updatePoints === 'function') updatePoints(-cost);
            alert('å·²ä¸ºä¸»è§’æä¾›æç¤ºï¼');
        }
    }
    function revealTruth() {
        const cost = getDiscountedCost(500);
        if(confirm(`ç¡®å®šæ¶ˆè€—${cost}ç§¯åˆ†å¹¶å¢åŠ 10åå™¬æ­ç¤ºçœŸç›¸ï¼Ÿ`)) {
            if(typeof updatePoints === 'function') updatePoints(-cost);
            if(typeof updateBacklash === 'function') updateBacklash(10);
            alert('çœŸç›¸å·²æ­ç¤ºï¼');
        }
    }
    function memoryEdit() {
        const cost = getDiscountedCost(2000);
        if(confirm(`ç¡®å®šæ¶ˆè€—${cost}ç§¯åˆ†è¿›è¡Œè®°å¿†ç¼–è¾‘ï¼Ÿ`)) {
            if(typeof updatePoints === 'function') updatePoints(-cost);
            alert('è®°å¿†ç¼–è¾‘å·²æ‰§è¡Œï¼ˆæ¼”ç¤ºæ•ˆæœï¼‰');
        }
    }
    function timeRewind() {
        const cost = getDiscountedCost(5000);
        if(confirm(`ç¡®å®šæ¶ˆè€—${cost}ç§¯åˆ†è¿›è¡Œæ—¶å…‰å›æº¯ï¼Ÿ`)) {
            if(typeof updatePoints === 'function') updatePoints(-cost);
            alert('æ—¶å…‰å›æº¯å·²æ‰§è¡Œï¼ˆæ¼”ç¤ºæ•ˆæœï¼‰');
        }
    }
    function materialize() {
        const cost = getDiscountedCost(10000);
        if(confirm(`ç¡®å®šæ¶ˆè€—${cost}ç§¯åˆ†è¿›è¡Œå®ä½“åŒ–ï¼Ÿ`)) {
            if(typeof updatePoints === 'function') updatePoints(-cost);
            alert('å®ä½“åŒ–å·²æ‰§è¡Œï¼ˆæ¼”ç¤ºæ•ˆæœï¼‰');
        }
    }

    // è¦†ç›–æš‚åœæ—¶é—´åŠŸèƒ½æ¶ˆè€—
    function pauseTime() {
        const cost = getDiscountedCost(300);
        if(confirm(`æš‚åœæ—¶é—´å°†æ¶ˆè€—${cost}ç§¯åˆ†ï¼ŒæŒç»­10ç§’ã€‚ç¡®å®šå—ï¼Ÿ`)) {
            document.body.style.filter = 'grayscale(50%)';
            var sceneWin = document.querySelector('.scene-window');
            if(sceneWin) sceneWin.style.opacity = '0.5';

            // æ˜¾ç¤ºæš‚åœæç¤º
            const pauseIndicator = document.createElement('div');
            pauseIndicator.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 48px;
                color: #00ff88;
                text-shadow: 0 0 20px #00ff88;
                z-index: 9999;
            `;
            pauseIndicator.textContent = 'â¸ æ—¶é—´æš‚åœä¸­';
            document.body.appendChild(pauseIndicator);

            // 10ç§’åæ¢å¤
            setTimeout(() => {
                document.body.style.filter = '';
                if(sceneWin) sceneWin.style.opacity = '1';
                pauseIndicator.remove();
            }, 10000);

            if(typeof updatePoints === 'function') {
                updatePoints(-cost);
            }
        }
    }
        // tabåˆ‡æ¢
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const tab = this.getAttribute('data-tab');
                    document.querySelectorAll('.tab-panel').forEach(panel => {
                        panel.style.display = (panel.getAttribute('data-tab') === tab) ? 'block' : 'none';
                    });
                });
            });
            // åˆå§‹åŒ–å•†åŸå•†å“æ¸²æŸ“
            renderShopItems();
        });

        // å•†åŸå•†å“æ•°æ®ï¼ˆåˆå§‹å•†å“ï¼‰
        let shopProducts = [
            { name: 'æ´å¯Ÿç¬¦', desc: 'æŸ¥çœ‹NPCå¥½æ„Ÿåº¦', price: 500, stock: 99, color: '#00ff88', border: '#00ff88', bg: 'rgba(0,255,136,0.1)' },
            { name: 'è®°å¿†æ¨¡ç³Šä¸¹', desc: 'è®©NPCå¿˜è®°ä¸€ä»¶å°äº‹', price: 2000, stock: 50, color: '#00ff88', border: '#00ff88', bg: 'rgba(0,255,136,0.1)' },
            { name: 'å‘½è¿åç§»å¡', desc: 'æ”¹å˜ä¸€æ¬¡å‰§æƒ…èµ°å‘', price: 10000, stock: 1, color: '#ff6666', border: '#ff6666', bg: 'rgba(255,100,100,0.1)', locked: true }
        ];

        // æ¸²æŸ“å•†åŸå•†å“
        function renderShopItems() {
            const shopGrid = document.querySelector('#shopModal .modal-body > div[style*="grid"]');
            if (!shopGrid) return;
            shopGrid.innerHTML = '';
            shopProducts.forEach((item, idx) => {
                let html = `
                <div class="shop-item" style="background:${item.bg};padding:15px;border:1px solid ${item.border};border-radius:5px;">
                    <h4 style="color:${item.color};">${item.name}</h4>
                    <p style="font-size:14px;margin:10px 0;">${item.desc || ''}</p>
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <span>${item.price}ç§¯åˆ†${typeof item.stock === 'number' ? ` | åº“å­˜:${item.stock}` : ''}</span>
                        ${
                            item.locked
                            ? `<button class="tool-button locked" style="padding:5px 10px;">æœªè§£é”</button>`
                            : `<button class="tool-button" style="padding:5px 10px;" onclick="editProduct(${idx})">ç¼–è¾‘</button>`
                        }
                    </div>
                </div>
                `;
                shopGrid.insertAdjacentHTML('beforeend', html);
            });
        }

        // æ˜¾ç¤ºä¸Šæ¶å•†å“å¼¹çª—
        function showAddProductModal() {
            document.getElementById('addProductModal').style.display = 'block';
        }

        // ç¼–è¾‘å•†å“å¼¹çª—
        let editingProductIndex = null;
        function editProduct(idx) {
            editingProductIndex = idx;
            const item = shopProducts[idx];
            document.getElementById('editProductName').value = item.name;
            document.getElementById('editProductDesc').value = item.desc || '';
            document.getElementById('editProductPrice').value = item.price;
            document.getElementById('editProductStock').value = typeof item.stock === 'number' ? item.stock : '';
            document.getElementById('editProductModal').style.display = 'block';
        }
        function saveEditProduct() {
            if (editingProductIndex === null) return;
            const price = parseInt(document.getElementById('editProductPrice').value);
            const stock = parseInt(document.getElementById('editProductStock').value);
            if (isNaN(price) || price <= 0 || isNaN(stock) || stock < 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ä»·æ ¼å’Œåº“å­˜');
                return;
            }
            shopProducts[editingProductIndex].price = price;
            shopProducts[editingProductIndex].stock = stock;
            renderShopItems();
            closeModal('editProductModal');
        }

        // æ·»åŠ æ–°å•†å“
        function addProduct() {
            const name = document.getElementById('productName').value.trim();
            const desc = document.getElementById('productDesc').value.trim();
            const price = parseInt(document.getElementById('productPrice').value);
            const stock = parseInt(document.getElementById('productStock').value);
            if (!name || isNaN(price) || isNaN(stock) || price <= 0 || stock < 0) {
                alert('è¯·å¡«å†™å®Œæ•´ä¸”æœ‰æ•ˆçš„å•†å“ä¿¡æ¯');
                return;
            }
            shopProducts.push({
                name,
                desc,
                price,
                stock,
                color: '#00ff88',
                border: '#00ff88',
                bg: 'rgba(0,255,136,0.1)'
            });
            renderShopItems();
            closeModal('addProductModal');
        }

        // å¼¹çª—äº¤äº’
        function showInfoControl() {
            document.getElementById('infoControlModal').style.display = 'block';
        }
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        function openShop() {
            document.getElementById('shopModal').style.display = 'block';
            renderShopItems();
        }
        // å…¶å®ƒå¼¹çª—å’Œäº¤äº’å‡½æ•°è¯·å‚è€ƒå‰¯æœ¬æ–‡ä»¶ï¼Œå·²åŒæ­¥
        // ...ï¼ˆå…¶ä½™JSå‡½æ•°å®Œæ•´ä¿ç•™ï¼Œä¸èƒ½çœç•¥ï¼‰...
// éšè—çœŸç›¸
function hideInfo() {
    alert('ä½ é€‰æ‹©éšè—éƒ¨åˆ†çœŸç›¸ï¼Œä¸»è§’å°†æ— æ³•è·çŸ¥å…³é”®çº¿ç´¢ã€‚\n\nä¿¡ä»»åº¦-3ï¼Œåå™¬å€¼+5');
    if(typeof updateTrust === 'function') updateTrust(-3);
    if(typeof updateBacklash === 'function') updateBacklash(5);
}

// è¯¯å¯¼ä¸»è§’
function mislead() {
    alert('ä½ é€‰æ‹©è¯¯å¯¼ä¸»è§’ï¼Œå‰§æƒ…å°†åç¦»åŸæœ‰è½¨è¿¹ã€‚\n\nä¿¡ä»»åº¦-8ï¼Œåå™¬å€¼+10');
    if(typeof updateTrust === 'function') updateTrust(-8);
    if(typeof updateBacklash === 'function') updateBacklash(10);
}

// ä¿æŒæ²‰é»˜
function staySilent() {
    alert('ä½ é€‰æ‹©ä¿æŒæ²‰é»˜ï¼Œä¸»è§’å°†è‡ªè¡Œæ‘¸ç´¢ã€‚\n\næ— æ¶ˆè€—');
}
// ç¡®è®¤é€éœ²ä¿¡æ¯
function confirmInfoReveal() {
    const checkedBoxes = document.querySelectorAll('#infoControlModal input[type="checkbox"]:checked');
    if(checkedBoxes.length === 0) {
        alert('è¯·è‡³å°‘é€‰æ‹©ä¸€æ¡ä¿¡æ¯');
        return;
    }
    // æ‰§è¡Œä¿¡æ¯é€éœ²
    let message = 'ã€ç³»ç»Ÿæç¤ºã€‘\n';
    checkedBoxes.forEach(box => {
        switch(box.id) {
            case 'info1':
                message += 'â€¢ æé•¿é£çœ‹ä½ çš„çœ¼ç¥æœ‰äº›å¼‚æ ·ï¼Œä¼¼ä¹åœ¨è¯•æ¢ä»€ä¹ˆ\n';
                break;
            case 'info2':
                message += 'â€¢ æŒé—¨æ­¤æ¬¡å¬è§å¹¶éå¶ç„¶ï¼Œè€Œæ˜¯ä¸€æ¬¡ç²¾å¿ƒå®‰æ’çš„è¯•æ¢\n';
                break;
            case 'info3':
                message += 'â€¢ å±é™©ï¼æŒé—¨å·²ç»çŸ¥é“ä½ èº«ä¸Šæœ‰ç‰¹æ®Šä¹‹å¤„\n';
                break;
            case 'info4':
                message += 'â€¢ è­¦å‘Šï¼å®—é—¨å†…éƒ¨å¹¶ä¸å®‰å…¨ï¼Œæœ‰å¤–æ•Œæ½œä¼\n';
                break;
        }
    });
    alert(message);
    closeModal('infoControlModal');
    // æ›´æ–°ç•Œé¢çŠ¶æ€
    if(typeof updateTrust === 'function') updateTrust(5);
    if(typeof updatePoints === 'function') updatePoints(-200);
}
// æ”¹ä»·åŠŸèƒ½
// setPrice å·²åºŸå¼ƒï¼Œä¿ç•™å…¼å®¹ä½†ä¸å†æ˜¾ç¤º
function setPrice(itemId) {
    alert('è¯·ä½¿ç”¨â€œç¼–è¾‘â€æŒ‰é’®ä¿®æ”¹å•†å“ä»·æ ¼å’Œåº“å­˜');
}

// é™æ—¶ä¼˜æƒ 
function createSale() {
    alert('é™æ—¶ä¼˜æƒ å·²å¼€å¯ï¼šæ‰€æœ‰å•†å“ä»·æ ¼å‡åŠï¼ˆæ¼”ç¤ºæ•ˆæœï¼‰');
    document.querySelectorAll('.shop-item span').forEach(span => {
        let val = parseInt(span.textContent);
        if(!isNaN(val)) span.textContent = Math.floor(val / 2) + 'ç§¯åˆ†';
    });
}

// éšè—éƒ¨åˆ†å•†å“
function hideItems() {
    alert('éƒ¨åˆ†å•†å“å·²éšè—ï¼ˆæ¼”ç¤ºæ•ˆæœï¼‰');
    const items = document.querySelectorAll('.shop-item');
    if(items.length > 2) items[2].style.display = 'none';
}

// åˆ¶é€ ç¼ºè´§å‡è±¡
function createFakeUrgency() {
    alert('åˆ¶é€ ç¼ºè´§å‡è±¡ï¼šéƒ¨åˆ†å•†å“æ˜¾ç¤ºâ€œç¼ºè´§â€æ ‡ç­¾ï¼ˆæ¼”ç¤ºæ•ˆæœï¼‰');
    const items = document.querySelectorAll('.shop-item');
    if(items.length > 1) {
        let tag = document.createElement('span');
        tag.textContent = 'ç¼ºè´§';
        tag.style.cssText = 'color:#ff4444;font-weight:bold;margin-left:10px;';
        items[1].appendChild(tag);
    }
}
// æš‚åœæ—¶é—´åŠŸèƒ½
function pauseTime() {
    if(confirm('æš‚åœæ—¶é—´å°†æ¶ˆè€—300ç§¯åˆ†ï¼ŒæŒç»­10ç§’ã€‚ç¡®å®šå—ï¼Ÿ')) {
        document.body.style.filter = 'grayscale(50%)';
        var sceneWin = document.querySelector('.scene-window');
        if(sceneWin) sceneWin.style.opacity = '0.5';

        // æ˜¾ç¤ºæš‚åœæç¤º
        const pauseIndicator = document.createElement('div');
        pauseIndicator.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            color: #00ff88;
            text-shadow: 0 0 20px #00ff88;
            z-index: 9999;
        `;
        pauseIndicator.textContent = 'â¸ æ—¶é—´æš‚åœä¸­';
        document.body.appendChild(pauseIndicator);

        // 10ç§’åæ¢å¤
        setTimeout(() => {
            document.body.style.filter = '';
            if(sceneWin) sceneWin.style.opacity = '1';
            pauseIndicator.remove();
        }, 10000);

        if(typeof updatePoints === 'function') {
            updatePoints(-300);
        }
    }
}
// æŸ¥çœ‹æ—¶é—´é”šç‚¹
function checkAnchors() {
    const anchorModal = document.createElement('div');
    anchorModal.className = 'modal';
    anchorModal.style.display = 'block';
    anchorModal.innerHTML = `
        <div class="modal-content" style="min-width: 700px;">
            <h2 class="modal-title">æ—¶é—´é”šç‚¹ç®¡ç†</h2>
            <div class="modal-body">
                <div style="display: flex; gap: 20px; overflow-x: auto; padding: 20px 0;">
                    <div class="time-anchor" style="min-width: 150px; text-align: center; cursor: pointer;" onclick="confirmRewind(1)">
                        <div style="width: 100px; height: 100px; margin: 0 auto; background: rgba(0,255,136,0.2); border: 2px solid #00ff88; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 24px;">ğŸ“</span>
                        </div>
                        <h4 style="margin-top: 10px;">åˆå…¥é’äº‘</h4>
                        <p style="font-size: 12px; opacity: 0.7;">3å¤©å‰</p>
                        <p style="font-size: 12px; color: #ffaa00;">åå™¬å€¼: +20</p>
                    </div>
                    <div class="time-anchor" style="min-width: 150px; text-align: center; cursor: pointer;" onclick="confirmRewind(2)">
                        <div style="width: 100px; height: 100px; margin: 0 auto; background: rgba(0,255,136,0.2); border: 2px solid #00ff88; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 24px;">ğŸ“</span>
                        </div>
                        <h4 style="margin-top: 10px;">å‰‘æ³•æ˜¾éœ²</h4>
                        <p style="font-size: 12px; opacity: 0.7;">1å¤©å‰</p>
                        <p style="font-size: 12px; color: #ffaa00;">åå™¬å€¼: +10</p>
                    </div>
                    <div class="time-anchor current" style="min-width: 150px; text-align: center;">
                        <div style="width: 100px; height: 100px; margin: 0 auto; background: rgba(255,255,0,0.2); border: 2px solid #ffff00; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 24px;">ğŸ“Œ</span>
                        </div>
                        <h4 style="margin-top: 10px;">å½“å‰æ—¶é—´ç‚¹</h4>
                        <p style="font-size: 12px; opacity: 0.7;">ç°åœ¨</p>
                    </div>
                </div>
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,0,0,0.2); border-radius: 5px;">
                    <strong>âš ï¸ è­¦å‘Šï¼š</strong>æ—¶é—´å›æº¯ä¼šç•™ä¸‹ç—•è¿¹ï¼Œé«˜æ„ŸçŸ¥NPCå¯èƒ½å¯Ÿè§‰å¼‚å¸¸ã€‚å½“å‰å·²å›æº¯ <span style="color: #ff4444;">2</span> æ¬¡ã€‚
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="this.closest('.modal').remove()">å…³é—­</button>
            </div>
        </div>
    `;
    document.body.appendChild(anchorModal);
}

// ç¡®è®¤æ—¶é—´å›æº¯
function confirmRewind(anchorId) {
    if(confirm(`ç¡®å®šè¦å›æº¯åˆ°è¿™ä¸ªæ—¶é—´ç‚¹å—ï¼Ÿ\n\nè¿™å°†ï¼š\n- æ¶ˆè€—å¤§é‡ç§¯åˆ†\n- å¢åŠ ä¸–ç•Œåå™¬å€¼\n- å¯èƒ½è¢«æŸäº›NPCå¯Ÿè§‰\n- ä¸»è§’ä¼šä¿ç•™éƒ¨åˆ†è®°å¿†ç¢ç‰‡`)) {
        alert('æ—¶é—´å›æº¯ä¸­...\n\nã€ç³»ç»Ÿæ—¥å¿—ã€‘\næ—¶é—´çº¿é‡æ„å®Œæˆ\næ£€æµ‹åˆ°3ä¸ªæ—¶é—´ç–¤ç—•\nè­¦å‘Šï¼šå¤©æœºé˜å¯èƒ½å·²å¯Ÿè§‰å¼‚å¸¸');
        if(typeof updateBacklash === 'function') {
            updateBacklash(anchorId === 1 ? 20 : 10);
        }
    }
}

// æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
function viewLogs() {
    const logModal = document.createElement('div');
    logModal.className = 'modal';
    logModal.style.display = 'block';
    logModal.innerHTML = `
        <div class="modal-content" style="min-width: 600px; max-height: 80vh; overflow-y: auto;">
            <h2 class="modal-title">ç³»ç»Ÿæ—¥å¿—</h2>
            <div class="modal-body">
                <div style="font-family: monospace; font-size: 14px; line-height: 1.6;">
                    <div class="log-entry" style="margin-bottom: 10px; padding: 10px; background: rgba(0,255,136,0.1);">
                        <span style="color: #00ff88;">[10:23:45]</span> ç³»ç»Ÿå¯åŠ¨ï¼Œç»‘å®šä¸»è§’ï¼šæ—å‡¡
                    </div>
                    <div class="log-entry" style="margin-bottom: 10px; padding: 10px; background: rgba(0,200,255,0.1);">
                        <span style="color: #00ccff;">[10:25:12]</span> æ£€æµ‹åˆ°å…³é”®å‰§æƒ…ç‚¹ï¼šæŒé—¨å¬è§
                    </div>
                    <div class="log-entry" style="margin-bottom: 10px; padding: 10px; background: rgba(255,170,0,0.1);">
                        <span style="color: #ffaa00;">[10:25:33]</span> NPCæé•¿é£æ€€ç–‘åº¦ä¸Šå‡è‡³35%
                    </div>
                    <div class="log-entry" style="margin-bottom: 10px; padding: 10px; background: rgba(255,0,0,0.1);">
                        <span style="color: #ff4444;">[10:26:01]</span> è­¦å‘Šï¼šæ£€æµ‹åˆ°é­”é—¨é—´è°æ´»åŠ¨
                    </div>
                    <div class="log-entry" style="margin-bottom: 10px; padding: 10px; background: rgba(0,255,136,0.1);">
                        <span style="color: #00ff88;">[10:27:15]</span> ä¸»è§’è¯·æ±‚æŸ¥çœ‹æé•¿é£å±æ€§ - å·²å“åº”
                    </div>
                    <div class="log-entry" style="margin-bottom: 10px; padding: 10px; background: rgba(255,255,0,0.1);">
                        <span style="color: #ffff00;">[10:28:02]</span> ä¸–ç•Œåå™¬å€¼è¾¾åˆ°45ï¼Œè¿›å…¥è­¦æˆ’çŠ¶æ€
                    </div>
                    <div class="log-entry" style="margin-bottom: 10px; padding: 10px; background: rgba(255,0,255,0.1);">
                        <span style="color: #ff00ff;">[10:28:45]</span> å¤©æœºé˜å¼€å§‹æ‰«æå¼‚å¸¸æ³¢åŠ¨
                    </div>
                </div>
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="tool-button" onclick="filterLogs('all')">å…¨éƒ¨</button>
                    <button class="tool-button" onclick="filterLogs('system')">ç³»ç»Ÿæ“ä½œ</button>
                    <button class="tool-button" onclick="filterLogs('world')">ä¸–ç•Œäº‹ä»¶</button>
                    <button class="tool-button" onclick="filterLogs('danger')">å±é™©è­¦å‘Š</button>
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="exportLogs()">å¯¼å‡ºæ—¥å¿—</button>
                <button class="tool-button" onclick="this.closest('.modal').remove()">å…³é—­</button>
            </div>
        </div>
    `;
    document.body.appendChild(logModal);
}

// æ—¥å¿—ç­›é€‰ï¼ˆå ä½ï¼Œå®é™…å¯æ‰©å±•ï¼‰
function filterLogs(type) {
    alert('ç­›é€‰åŠŸèƒ½ä»…ä¸ºæ¼”ç¤ºï¼Œå®é™…å¯æ ¹æ®typeå‚æ•°ç­›é€‰æ—¥å¿—å†…å®¹');
}

// å¯¼å‡ºæ—¥å¿—ï¼ˆå ä½ï¼Œå®é™…å¯æ‰©å±•ï¼‰
function exportLogs() {
    alert('å¯¼å‡ºåŠŸèƒ½ä»…ä¸ºæ¼”ç¤ºï¼Œå®é™…å¯å°†æ—¥å¿—å†…å®¹å¯¼å‡ºä¸ºæ–‡ä»¶');
}
// åˆ›å»ºä»»åŠ¡
function createTask() {
    const taskModal = document.createElement('div');
    taskModal.className = 'modal';
    taskModal.style.display = 'block';
    taskModal.innerHTML = `
        <div class="modal-content" style="min-width: 500px;">
            <h2 class="modal-title">ä»»åŠ¡ç¼–è¾‘å™¨</h2>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">ä»»åŠ¡åç§°ï¼ˆä¸»è§’å¯è§ï¼‰</label>
                    <input type="text" id="taskName" style="width: 100%; padding: 8px; background: #1a1a1a; border: 1px solid #00ff88; color: #fff;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">è¡¨é¢ç›®æ ‡</label>
                    <textarea id="taskGoal" style="width: 100%; padding: 8px; background: #1a1a1a; border: 1px solid #00ff88; color: #fff; height: 60px;"></textarea>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">çœŸå®ç›®çš„ï¼ˆä»…ç³»ç»Ÿå¯è§ï¼‰</label>
                    <textarea id="taskTrueGoal" style="width: 100%; padding: 8px; background: #1a1a1a; border: 1px solid #ff4444; color: #ff4444; height: 60px;"></textarea>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">å¥–åŠ±è®¾ç½®</label>
                    <input type="text" id="taskReward" placeholder="ç§¯åˆ†æ•°é‡" style="width: 100%; padding: 8px; background: #1a1a1a; border: 1px solid #00ff88; color: #fff;">
                </div>
                <div style="padding: 10px; background: rgba(255,170,0,0.2); border-radius: 5px;">
                    <strong>éšè—åæœï¼š</strong>
                    <select id="taskConsequence" style="background: #1a1a1a; color: #fff; padding: 5px; margin-left: 10px;">
                        <option value="none">æ— </option>
                        <option value="npc_doubt">å¢åŠ NPCæ€€ç–‘</option>
                        <option value="trap">è§¦å‘é™·é˜±äº‹ä»¶</option>
                        <option value="faction_change">æ”¹å˜åŠ¿åŠ›å…³ç³»</option>
                    </select>
                </div>
            </div>
            <div class="modal-actions">
                <button class="tool-button" onclick="publishTask(this)">å‘å¸ƒä»»åŠ¡</button>
                <button class="tool-button" onclick="this.closest('.modal').remove()">å–æ¶ˆ</button>
            </div>
        </div>
    `;
    document.body.appendChild(taskModal);
}

// å‘å¸ƒä»»åŠ¡
function publishTask(button) {
    const modal = button.closest('.modal');
    const taskName = modal.querySelector('#taskName').value;
    const taskGoal = modal.querySelector('#taskGoal').value;
    if(!taskName || !taskGoal) {
        alert('è¯·å¡«å†™ä»»åŠ¡åç§°å’Œç›®æ ‡');
        return;
    }
    alert(`ä»»åŠ¡"${taskName}"å·²å‘å¸ƒç»™ä¸»è§’ï¼`);
    modal.remove();
    // åœ¨ä¸»ç•Œé¢æ˜¾ç¤ºæ–°ä»»åŠ¡æç¤º
    showNotification('æ–°ä»»åŠ¡å·²å‘å¸ƒ', 'task');
}

// æ˜¾ç¤ºé€šçŸ¥
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        padding: 15px 25px;
        background: ${type === 'task' ? 'rgba(0,255,136,0.9)' : 'rgba(0,200,255,0.9)'};
        color: #000;
        border-radius: 5px;
        font-weight: bold;
        animation: slideIn 0.3s ease;
        z-index: 1000;
    `;
    notification.textContent = message;
    document.body.appendChild(notification);
    setTimeout(() => notification.remove(), 3000);
}
document.addEventListener('DOMContentLoaded', function() {
   var btn = document.getElementById('memoryEditBtn');
   if(btn) {
       btn.onclick = function() {
           var modal = document.getElementById('memoryEditModal');
           if(modal) modal.style.display = 'block';
       }
   }
});
</script>
</script>
</body>
</html>